function Shatter(a,b,c,d){this.img=a,this.numPolys=b,this.images=[];var e,c=c||1;e=this.getPolys(a.width,a.height,b),this.roundVertices(e),this.calcBoundaries(e,this.img),this.scaleCoordinates(e,c),this.images=this.spliceImage(e,a),d&&(this.debug=this.getDebugImage(e,"#fff"))}!function(){function a(a,b){return a<b?-1:a>b?1:a>=b?0:NaN}function b(a){return null===a?NaN:+a}function c(a){return!isNaN(a)}function d(a){return{left:function(b,c,d,e){for(arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);d<e;){var f=d+e>>>1;a(b[f],c)<0?d=f+1:e=f}return d},right:function(b,c,d,e){for(arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);d<e;){var f=d+e>>>1;a(b[f],c)>0?e=f:d=f+1}return d}}}function e(a){return a.length}function f(a){for(var b=1;a*b%1;)b*=10;return b}function g(a,b){for(var c in b)Object.defineProperty(a.prototype,c,{value:b[c],enumerable:!1})}function h(){this._=Object.create(null)}function i(a){return(a+="")===Z||a[0]===$?$+a:a}function j(a){return(a+="")[0]===$?a.slice(1):a}function k(a){return i(a)in this._}function l(a){return(a=i(a))in this._&&delete this._[a]}function m(){var a=[];for(var b in this._)a.push(j(b));return a}function n(){var a=0;for(var b in this._)++a;return a}function o(){for(var a in this._)return!1;return!0}function p(){this._=Object.create(null)}function q(a){return"function"==typeof a?a:function(){return a}}function r(){N(this),this.edge=this.site=this.circle=null}function s(a){var b=ga.pop()||new r;return b.site=a,b}function t(a){D(a),ba.remove(a),ga.push(a),N(a)}function u(a){var b=a.circle,c=b.x,d=b.cy,e={x:c,y:d},f=a.P,g=a.N,h=[a];t(a);for(var i=f;i.circle&&Y(c-i.circle.x)<ea&&Y(d-i.circle.cy)<ea;)f=i.P,h.unshift(i),t(i),i=f;h.unshift(i),D(i);for(var j=g;j.circle&&Y(c-j.circle.x)<ea&&Y(d-j.circle.cy)<ea;)g=j.N,h.push(j),t(j),j=g;h.push(j),D(j);var k,l=h.length;for(k=1;k<l;++k)j=h[k],i=h[k-1],K(j.edge,i.site,j.site,e);i=h[0],j=h[l-1],j.edge=I(i.site,j.site,null,e),C(i),C(j)}function v(a){for(var b,c,d,e,f=a.x,g=a.y,h=ba._;h;)if(d=w(h,g)-f,d>ea)h=h.L;else{if(e=f-x(h,g),!(e>ea)){d>-ea?(b=h.P,c=h):e>-ea?(b=h,c=h.N):b=c=h;break}if(!h.R){b=h;break}h=h.R}var i=s(a);if(ba.insert(b,i),b||c){if(b===c)return D(b),c=s(b.site),ba.insert(i,c),i.edge=c.edge=I(b.site,i.site),C(b),void C(c);if(!c)return void(i.edge=I(b.site,i.site));D(b),D(c);var j=b.site,k=j.x,l=j.y,m=a.x-k,n=a.y-l,o=c.site,p=o.x-k,q=o.y-l,r=2*(m*q-n*p),t=m*m+n*n,u=p*p+q*q,v={x:(q*t-n*u)/r+k,y:(m*u-p*t)/r+l};K(c.edge,j,o,v),i.edge=I(j,a,null,v),c.edge=I(a,o,null,v),C(b),C(c)}}function w(a,b){var c=a.site,d=c.x,e=c.y,f=e-b;if(!f)return d;var g=a.P;if(!g)return-(1/0);c=g.site;var h=c.x,i=c.y,j=i-b;if(!j)return h;var k=h-d,l=1/f-1/j,m=k/j;return l?(-m+Math.sqrt(m*m-2*l*(k*k/(-2*j)-i+j/2+e-f/2)))/l+d:(d+h)/2}function x(a,b){var c=a.N;if(c)return w(c,b);var d=a.site;return d.y===b?d.x:1/0}function y(a){this.site=a,this.edges=[]}function z(a){for(var b,c,d,e,f,g,h,i,j,k,l=a[0][0],m=a[1][0],n=a[0][1],o=a[1][1],p=aa,q=p.length;q--;)if(f=p[q],f&&f.prepare())for(h=f.edges,i=h.length,g=0;g<i;)k=h[g].end(),d=k.x,e=k.y,j=h[++g%i].start(),b=j.x,c=j.y,(Y(d-b)>ea||Y(e-c)>ea)&&(h.splice(g,0,new L(J(f.site,k,Y(d-l)<ea&&o-e>ea?{x:l,y:Y(b-l)<ea?c:o}:Y(e-o)<ea&&m-d>ea?{x:Y(c-o)<ea?b:m,y:o}:Y(d-m)<ea&&e-n>ea?{x:m,y:Y(b-m)<ea?c:n}:Y(e-n)<ea&&d-l>ea?{x:Y(c-n)<ea?b:l,y:n}:null),f.site,null)),++i)}function A(a,b){return b.angle-a.angle}function B(){N(this),this.x=this.y=this.arc=this.site=this.cy=null}function C(a){var b=a.P,c=a.N;if(b&&c){var d=b.site,e=a.site,f=c.site;if(d!==f){var g=e.x,h=e.y,i=d.x-g,j=d.y-h,k=f.x-g,l=f.y-h,m=2*(i*l-j*k);if(!(m>=-fa)){var n=i*i+j*j,o=k*k+l*l,p=(l*n-j*o)/m,q=(i*o-k*n)/m,l=q+h,r=ha.pop()||new B;r.arc=a,r.site=e,r.x=p+g,r.y=l+Math.sqrt(p*p+q*q),r.cy=l,a.circle=r;for(var s=null,t=da._;t;)if(r.y<t.y||r.y===t.y&&r.x<=t.x){if(!t.L){s=t.P;break}t=t.L}else{if(!t.R){s=t;break}t=t.R}da.insert(s,r),s||(ca=r)}}}}function D(a){var b=a.circle;b&&(b.P||(ca=b.N),da.remove(b),ha.push(b),N(b),a.circle=null)}function E(a,b,c,d){return function(e){var f,g=e.a,h=e.b,i=g.x,j=g.y,k=h.x,l=h.y,m=0,n=1,o=k-i,p=l-j;if(f=a-i,o||!(f>0)){if(f/=o,o<0){if(f<m)return;f<n&&(n=f)}else if(o>0){if(f>n)return;f>m&&(m=f)}if(f=c-i,o||!(f<0)){if(f/=o,o<0){if(f>n)return;f>m&&(m=f)}else if(o>0){if(f<m)return;f<n&&(n=f)}if(f=b-j,p||!(f>0)){if(f/=p,p<0){if(f<m)return;f<n&&(n=f)}else if(p>0){if(f>n)return;f>m&&(m=f)}if(f=d-j,p||!(f<0)){if(f/=p,p<0){if(f>n)return;f>m&&(m=f)}else if(p>0){if(f<m)return;f<n&&(n=f)}return m>0&&(e.a={x:i+m*o,y:j+m*p}),n<1&&(e.b={x:i+n*o,y:j+n*p}),e}}}}}}function F(a){for(var b,c=_,d=E(a[0][0],a[0][1],a[1][0],a[1][1]),e=c.length;e--;)b=c[e],(!G(b,a)||!d(b)||Y(b.a.x-b.b.x)<ea&&Y(b.a.y-b.b.y)<ea)&&(b.a=b.b=null,c.splice(e,1))}function G(a,b){var c=a.b;if(c)return!0;var d,e,f=a.a,g=b[0][0],h=b[1][0],i=b[0][1],j=b[1][1],k=a.l,l=a.r,m=k.x,n=k.y,o=l.x,p=l.y,q=(m+o)/2,r=(n+p)/2;if(p===n){if(q<g||q>=h)return;if(m>o){if(f){if(f.y>=j)return}else f={x:q,y:i};c={x:q,y:j}}else{if(f){if(f.y<i)return}else f={x:q,y:j};c={x:q,y:i}}}else if(d=(m-o)/(p-n),e=r-d*q,d<-1||d>1)if(m>o){if(f){if(f.y>=j)return}else f={x:(i-e)/d,y:i};c={x:(j-e)/d,y:j}}else{if(f){if(f.y<i)return}else f={x:(j-e)/d,y:j};c={x:(i-e)/d,y:i}}else if(n<p){if(f){if(f.x>=h)return}else f={x:g,y:d*g+e};c={x:h,y:d*h+e}}else{if(f){if(f.x<g)return}else f={x:h,y:d*h+e};c={x:g,y:d*g+e}}return a.a=f,a.b=c,!0}function H(a,b){this.l=a,this.r=b,this.a=this.b=null}function I(a,b,c,d){var e=new H(a,b);return _.push(e),c&&K(e,a,b,c),d&&K(e,b,a,d),aa[a.i].edges.push(new L(e,a,b)),aa[b.i].edges.push(new L(e,b,a)),e}function J(a,b,c){var d=new H(a,null);return d.a=b,d.b=c,_.push(d),d}function K(a,b,c,d){a.a||a.b?a.l===c?a.b=d:a.a=d:(a.a=d,a.l=b,a.r=c)}function L(a,b,c){var d=a.a,e=a.b;this.edge=a,this.site=b,this.angle=c?Math.atan2(c.y-b.y,c.x-b.x):a.l===b?Math.atan2(e.x-d.x,d.y-e.y):Math.atan2(d.x-e.x,e.y-d.y)}function M(){this._=null}function N(a){a.U=a.C=a.L=a.R=a.P=a.N=null}function O(a,b){var c=b,d=b.R,e=c.U;e?e.L===c?e.L=d:e.R=d:a._=d,d.U=e,c.U=d,c.R=d.L,c.R&&(c.R.U=c),d.L=c}function P(a,b){var c=b,d=b.L,e=c.U;e?e.L===c?e.L=d:e.R=d:a._=d,d.U=e,c.U=d,c.L=d.R,c.L&&(c.L.U=c),d.R=c}function Q(a){for(;a.L;)a=a.L;return a}function R(a,b){var c,d,e,f=a.sort(S).pop();for(_=[],aa=new Array(a.length),ba=new M,da=new M;;)if(e=ca,f&&(!e||f.y<e.y||f.y===e.y&&f.x<e.x))f.x===c&&f.y===d||(aa[f.i]=new y(f),v(f),c=f.x,d=f.y),f=a.pop();else{if(!e)break;u(e.arc)}b&&(F(b),z(b));var g={cells:aa,edges:_};return ba=da=_=aa=null,g}function S(a,b){return b.y-a.y||b.x-a.x}function T(a){return a[0]}function U(a){return a[1]}function V(a,b,c){return(a.x-c.x)*(b.y-a.y)-(a.x-b.x)*(c.y-a.y)}var W={version:"3.5.17"};W.ascending=a,W.descending=function(a,b){return b<a?-1:b>a?1:b>=a?0:NaN},W.min=function(a,b){var c,d,e=-1,f=a.length;if(1===arguments.length){for(;++e<f;)if(null!=(d=a[e])&&d>=d){c=d;break}for(;++e<f;)null!=(d=a[e])&&c>d&&(c=d)}else{for(;++e<f;)if(null!=(d=b.call(a,a[e],e))&&d>=d){c=d;break}for(;++e<f;)null!=(d=b.call(a,a[e],e))&&c>d&&(c=d)}return c},W.max=function(a,b){var c,d,e=-1,f=a.length;if(1===arguments.length){for(;++e<f;)if(null!=(d=a[e])&&d>=d){c=d;break}for(;++e<f;)null!=(d=a[e])&&d>c&&(c=d)}else{for(;++e<f;)if(null!=(d=b.call(a,a[e],e))&&d>=d){c=d;break}for(;++e<f;)null!=(d=b.call(a,a[e],e))&&d>c&&(c=d)}return c},W.extent=function(a,b){var c,d,e,f=-1,g=a.length;if(1===arguments.length){for(;++f<g;)if(null!=(d=a[f])&&d>=d){c=e=d;break}for(;++f<g;)null!=(d=a[f])&&(c>d&&(c=d),e<d&&(e=d))}else{for(;++f<g;)if(null!=(d=b.call(a,a[f],f))&&d>=d){c=e=d;break}for(;++f<g;)null!=(d=b.call(a,a[f],f))&&(c>d&&(c=d),e<d&&(e=d))}return[c,e]},W.sum=function(a,b){var d,e=0,f=a.length,g=-1;if(1===arguments.length)for(;++g<f;)c(d=+a[g])&&(e+=d);else for(;++g<f;)c(d=+b.call(a,a[g],g))&&(e+=d);return e},W.mean=function(a,d){var e,f=0,g=a.length,h=-1,i=g;if(1===arguments.length)for(;++h<g;)c(e=b(a[h]))?f+=e:--i;else for(;++h<g;)c(e=b(d.call(a,a[h],h)))?f+=e:--i;if(i)return f/i},W.quantile=function(a,b){var c=(a.length-1)*b+1,d=Math.floor(c),e=+a[d-1],f=c-d;return f?e+f*(a[d]-e):e},W.median=function(d,e){var f,g=[],h=d.length,i=-1;if(1===arguments.length)for(;++i<h;)c(f=b(d[i]))&&g.push(f);else for(;++i<h;)c(f=b(e.call(d,d[i],i)))&&g.push(f);if(g.length)return W.quantile(g.sort(a),.5)},W.variance=function(a,d){var e,f,g=a.length,h=0,i=0,j=-1,k=0;if(1===arguments.length)for(;++j<g;)c(e=b(a[j]))&&(f=e-h,h+=f/++k,i+=f*(e-h));else for(;++j<g;)c(e=b(d.call(a,a[j],j)))&&(f=e-h,h+=f/++k,i+=f*(e-h));if(k>1)return i/(k-1)},W.deviation=function(){var a=W.variance.apply(this,arguments);return a?Math.sqrt(a):a};var X=d(a);W.bisectLeft=X.left,W.bisect=W.bisectRight=X.right,W.bisector=function(b){return d(1===b.length?function(c,d){return a(b(c),d)}:b)},W.shuffle=function(a,b,c){(f=arguments.length)<3&&(c=a.length,f<2&&(b=0));for(var d,e,f=c-b;f;)e=Math.random()*f--|0,d=a[f+b],a[f+b]=a[e+b],a[e+b]=d;return a},W.permute=function(a,b){for(var c=b.length,d=new Array(c);c--;)d[c]=a[b[c]];return d},W.pairs=function(a){for(var b,c=0,d=a.length-1,e=a[0],f=new Array(d<0?0:d);c<d;)f[c]=[b=e,e=a[++c]];return f},W.transpose=function(a){if(!(f=a.length))return[];for(var b=-1,c=W.min(a,e),d=new Array(c);++b<c;)for(var f,g=-1,h=d[b]=new Array(f);++g<f;)h[g]=a[g][b];return d},W.zip=function(){return W.transpose(arguments)},W.keys=function(a){var b=[];for(var c in a)b.push(c);return b},W.values=function(a){var b=[];for(var c in a)b.push(a[c]);return b},W.entries=function(a){var b=[];for(var c in a)b.push({key:c,value:a[c]});return b},W.merge=function(a){for(var b,c,d,e=a.length,f=-1,g=0;++f<e;)g+=a[f].length;for(c=new Array(g);--e>=0;)for(d=a[e],b=d.length;--b>=0;)c[--g]=d[b];return c};var Y=Math.abs;W.range=function(a,b,c){if(arguments.length<3&&(c=1,arguments.length<2&&(b=a,a=0)),(b-a)/c===1/0)throw new Error("infinite range");var d,e=[],g=f(Y(c)),h=-1;if(a*=g,b*=g,c*=g,c<0)for(;(d=a+c*++h)>b;)e.push(d/g);else for(;(d=a+c*++h)<b;)e.push(d/g);return e},W.map=function(a,b){var c=new h;if(a instanceof h)a.forEach(function(a,b){c.set(a,b)});else if(Array.isArray(a)){var d,e=-1,f=a.length;if(1===arguments.length)for(;++e<f;)c.set(e,a[e]);else for(;++e<f;)c.set(b.call(a,d=a[e],e),d)}else for(var g in a)c.set(g,a[g]);return c};var Z="__proto__",$="\0";g(h,{has:k,get:function(a){return this._[i(a)]},set:function(a,b){return this._[i(a)]=b},remove:l,keys:m,values:function(){var a=[];for(var b in this._)a.push(this._[b]);return a},entries:function(){var a=[];for(var b in this._)a.push({key:j(b),value:this._[b]});return a},size:n,empty:o,forEach:function(a){for(var b in this._)a.call(this,j(b),this._[b])}}),W.nest=function(){function a(b,g,i){if(i>=f.length)return d?d.call(e,g):c?g.sort(c):g;for(var j,k,l,m,n=-1,o=g.length,p=f[i++],q=new h;++n<o;)(m=q.get(j=p(k=g[n])))?m.push(k):q.set(j,[k]);return b?(k=b(),l=function(c,d){k.set(c,a(b,d,i))}):(k={},l=function(c,d){k[c]=a(b,d,i)}),q.forEach(l),k}function b(a,c){if(c>=f.length)return a;var d=[],e=g[c++];return a.forEach(function(a,e){d.push({key:a,values:b(e,c)})}),e?d.sort(function(a,b){return e(a.key,b.key)}):d}var c,d,e={},f=[],g=[];return e.map=function(b,c){return a(c,b,0)},e.entries=function(c){return b(a(W.map,c,0),0)},e.key=function(a){return f.push(a),e},e.sortKeys=function(a){return g[f.length-1]=a,e},e.sortValues=function(a){return c=a,e},e.rollup=function(a){return d=a,e},e},W.set=function(a){var b=new p;if(a)for(var c=0,d=a.length;c<d;++c)b.add(a[c]);return b},g(p,{has:k,add:function(a){return this._[i(a+="")]=!0,a},remove:l,values:m,size:n,empty:o,forEach:function(a){for(var b in this._)a.call(this,j(b))}}),W.functor=q;var _,aa,ba,ca,da,ea=1e-6,fa=ea*ea,ga=(Math.PI,[]),ha=[];y.prototype.prepare=function(){for(var a,b=this.edges,c=b.length;c--;)a=b[c].edge,a.b&&a.a||b.splice(c,1);return b.sort(A),b.length},L.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},M.prototype={insert:function(a,b){var c,d,e;if(a){if(b.P=a,b.N=a.N,a.N&&(a.N.P=b),a.N=b,a.R){for(a=a.R;a.L;)a=a.L;a.L=b}else a.R=b;c=a}else this._?(a=Q(this._),b.P=null,b.N=a,a.P=a.L=b,c=a):(b.P=b.N=null,this._=b,c=null);for(b.L=b.R=null,b.U=c,b.C=!0,a=b;c&&c.C;)d=c.U,c===d.L?(e=d.R,e&&e.C?(c.C=e.C=!1,d.C=!0,a=d):(a===c.R&&(O(this,c),a=c,c=a.U),c.C=!1,d.C=!0,P(this,d))):(e=d.L,e&&e.C?(c.C=e.C=!1,d.C=!0,a=d):(a===c.L&&(P(this,c),a=c,c=a.U),c.C=!1,d.C=!0,O(this,d))),c=a.U;this._.C=!1},remove:function(a){a.N&&(a.N.P=a.P),a.P&&(a.P.N=a.N),a.N=a.P=null;var b,c,d,e=a.U,f=a.L,g=a.R;if(c=f?g?Q(g):f:g,e?e.L===a?e.L=c:e.R=c:this._=c,f&&g?(d=c.C,c.C=a.C,c.L=f,f.U=c,c!==g?(e=c.U,c.U=a.U,a=c.R,e.L=a,c.R=g,g.U=c):(c.U=e,e=c,a=c.R)):(d=a.C,a=c),a&&(a.U=e),!d){if(a&&a.C)return void(a.C=!1);do{if(a===this._)break;if(a===e.L){if(b=e.R,b.C&&(b.C=!1,e.C=!0,O(this,e),b=e.R),b.L&&b.L.C||b.R&&b.R.C){b.R&&b.R.C||(b.L.C=!1,b.C=!0,P(this,b),b=e.R),b.C=e.C,e.C=b.R.C=!1,O(this,e),a=this._;break}}else if(b=e.L,b.C&&(b.C=!1,e.C=!0,P(this,e),b=e.L),b.L&&b.L.C||b.R&&b.R.C){b.L&&b.L.C||(b.R.C=!1,b.C=!0,O(this,b),b=e.L),b.C=e.C,e.C=b.L.C=!1,P(this,e),a=this._;break}b.C=!0,a=e,e=e.U}while(!a.C);a&&(a.C=!1)}}},W.geom={},W.geom.voronoi=function(a){function b(a){var b=new Array(a.length),d=h[0][0],e=h[0][1],f=h[1][0],g=h[1][1];return R(c(a),h).cells.forEach(function(c,h){var i=c.edges,j=c.site,k=b[h]=i.length?i.map(function(a){var b=a.start();return[b.x,b.y]}):j.x>=d&&j.x<=f&&j.y>=e&&j.y<=g?[[d,g],[f,g],[f,e],[d,e]]:[];k.point=a[h]}),b}function c(a){return a.map(function(a,b){return{x:Math.round(f(a,b)/ea)*ea,y:Math.round(g(a,b)/ea)*ea,i:b}})}var d=T,e=U,f=d,g=e,h=ia;return a?b(a):(b.links=function(a){return R(c(a)).edges.filter(function(a){return a.l&&a.r}).map(function(b){return{source:a[b.l.i],target:a[b.r.i]}})},b.triangles=function(a){var b=[];return R(c(a)).cells.forEach(function(c,d){for(var e,f,g=c.site,h=c.edges.sort(A),i=-1,j=h.length,k=h[j-1].edge,l=k.l===g?k.r:k.l;++i<j;)e=k,f=l,k=h[i].edge,l=k.l===g?k.r:k.l,d<f.i&&d<l.i&&V(g,f,l)<0&&b.push([a[d],a[f.i],a[l.i]])}),b},b.x=function(a){return arguments.length?(f=q(d=a),b):d},b.y=function(a){return arguments.length?(g=q(e=a),b):e},b.clipExtent=function(a){return arguments.length?(h=null==a?ia:a,b):h===ia?null:h},b.size=function(a){return arguments.length?b.clipExtent(a&&[[0,0],a]):h===ia?null:h&&h[1]},b)};var ia=[[-1e6,-1e6],[1e6,1e6]];"function"==typeof define&&define.amd?(this.d3=W,define(W)):"object"==typeof module&&module.exports?module.exports=W:this.d3=W}(),Shatter.prototype.getPolys=function(a,b,c){var d=d3.range(c).map(function(c){return[Math.random()*a,Math.random()*b]}),e=d3.geom.voronoi().clipExtent([[0,0],[a,b]]),f=e(d);return f},Shatter.prototype.roundVertices=function(a){a.forEach(function(a){a.forEach(function(a){a[0]=Math.round(a[0]),a[1]=Math.round(a[1])})})},Shatter.prototype.scaleCoordinates=function(a,b){var b=b;a.forEach(function(a){a.points=[];var c=(a.maxX+a.minX)/2,d=(a.maxY+a.minY)/2;a.forEach(function(e){var f=e[0]-a.minX,g=e[1]-a.minY;f=Math.round(b*(f-c)+c),g=Math.round(b*(g-d)+d),a.points.push(f,g)})})},Shatter.prototype.calcBoundaries=function(a,b){a.forEach(function(a){a.minX=b.width,a.minY=b.height,a.maxX=0,a.maxY=0,a.forEach(function(b){a.minX=b[0]<a.minX?b[0]:a.minX,a.minY=b[1]<a.minY?b[1]:a.minY,a.maxX=b[0]>a.maxX?b[0]:a.maxX,a.maxY=b[1]>a.maxY?b[1]:a.maxY})})},Shatter.prototype.spliceImage=function(a,b){imageList=[];var c=document.createElement("canvas");c.width=b.width,c.height=b.height;var d=c.getContext("2d");return d.save(),a.forEach(function(a){var e=Shatter.prototype.getClippedImage(a,d,c,b),f=Shatter.prototype.getCroppedImage(a,e);imageList.push({image:f,x:a.minX,y:a.minY,points:a.points}),f=null,d.restore(),d.clearRect(0,0,250,250),d.save()}),canvas=null,imageList},Shatter.prototype.getClippedImage=function(a,b,c,d){a.forEach(function(a,c,d){return 0===c?(b.beginPath(),void b.moveTo(a[0],a[1])):(b.lineTo(a[0],a[1]),void(c===d.length-1&&b.lineTo(d[0][0],d[0][1])))}),b.clip(),b.drawImage(d,0,0);var e=d.cloneNode();return e.src=c.toDataURL("image/png"),e},Shatter.prototype.getCroppedImage=function(a,b){var c=a.maxY-a.minY,d=a.maxX-a.minX,e=document.createElement("canvas");e.width=d,e.height=c,cropCtx=e.getContext("2d"),cropCtx.drawImage(b,-a.minX,-a.minY);var f=b.cloneNode();return f.src=e.toDataURL("image/png"),e=null,f},Shatter.prototype.getDebugImage=function(a,b){var c=document.createElement("canvas");c.width=this.img.width,c.height=this.img.height;var d=c.getContext("2d"),b=b||"#fff";a.forEach(function(a){a.forEach(function(a,b,c){return 0===b?(d.beginPath(),void d.moveTo(a[0],a[1])):(d.lineTo(a[0],a[1]),void(b===c.length-1&&d.lineTo(c[0][0],c[0][1])))}),d.closePath(),d.strokeStyle=b,d.stroke()});var e=this.img.cloneNode();return e.src=c.toDataURL("image/png"),e};